ext {
    trackAsiaArtifactGroupId = 'io.github.track-asia'
    trackAsiaArtifactId = project.hasProperty('POM_ARTIFACT_ID') ? project.property('POM_ARTIFACT_ID') : System.getenv('POM_ARTIFACT_ID')
    trackAsiaArtifactTitle = 'TrackAsia Android Java Utilities'
    trackAsiaArtifactDescription = project.hasProperty('POM_DESCRIPTION') ? project.property('POM_DESCRIPTION') : System.getenv('POM_DESCRIPTION')
    trackAsiaDeveloperName = 'TrackAsia'
    trackAsiaDeveloperEmail = 'trackasia@track-asia.com'
    trackAsiaDeveloperOrganization = 'TrackAsia'
    trackAsiaDeveloperOrganizationUrl = 'http://www.track-asia.com'
    trackAsiaDeveloperId = 'trackasia'
    trackAsiaArtifactUrl = 'https://github.com/track-asia/trackasia-java'
    trackAsiaArtifactVcsUrl = 'https://github.com/track-asia/trackasia-java.git'
    trackAsiaArtifactScmUrl = 'scm:git@github.com:trackasia/trackasia-java.git'
    trackAsiaArtifactLicenseName = 'The Apache Software License, Version 2.0'
    trackAsiaArtifactLicenseUrl = 'http://www.apache.org/licenses/LICENSE-2.0.txt'
    versionName = "2.0.1"
    isSnapshot = isSnapshot()
}

def getVersionName() {
    def version = System.getenv('VERSION')
    def deducedVersion = isSnapshot() ? getSnapshotVersion(version) : version
    project.logger.info("Project version detected: ${deducedVersion}")
    return deducedVersion
}

def isSnapshot() {
    def snapshotProp = findProperty("snapshot")
    return snapshotProp ? snapshotProp.asBoolean() : false
}

private static def getSnapshotVersion(String version) {
    def matcher = version =~ /^[v|V](\d+).(\d+)?.*/
    def major = (matcher[0][1] as Integer)
    def minor = (matcher[0][2] as Integer) + 1
    return "${major}.${minor}.0-SNAPSHOT"
}
